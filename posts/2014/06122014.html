<!DOCTYPE html>
<html>
<!-- Hack to Learn, Don't Learn to hack. -->
<!-- Created with all the love in the wereld || Mundo || World by Alexandre Juca -->
<!-- Site Generated by HoloPyEngine created by Alexandre Juca -->
<head> 
	<title> Aumentando os teus poderes com Cython </title>

	
	<meta charset='utf-8'></meta> 
	 <meta content="Alexandre Juca" property="og:title">
    <meta content="Alexandre Juca" name="twitter:title">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta content="Software developer, Web Developer Alexandre Juca" property="og:site_name">
    <meta content="Aumentando os teus poderes com Cython" name="description">
    <meta content="Aumentando os teus poderes com Cython" property="og:description">
    <meta content="Aumentando os teus poderes com Cython" name="twitter:description">
    <meta name="Author" content="Alexandre Juca" />

    <!-- Stylesheets -->
	<link rel='stylesheet' href='../../assets/css/nintendo-min.css' type='text/css'>
	<link rel='stylesheet' href='../../assets/css/animate-min.css' type='text/css'>
	<!-- End of Stylesheets -->

	<!-- Fonts -->
	<script src="//use.edgefonts.net/neuton.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Yanone+Kaffeesatz:400,300,700' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=VT323' rel='stylesheet' type='text/css'>
	<!-- End of Fonts -->

	<!-- FontAwesome -->
	<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
	<!-- FontAwesome -->
        <link rel='stylesheet' href='../../assets/css/style-a.css' type='text/css'> 
        <link rel='stylesheet' href='../../assets/css/console.css' type='text/css'> 

<body class='body'>
	<nav class='navbar navbar-default'>

		<!-- SOCIAL LINKS -->
		<div class='social-box'>
			<ul class='social-links-holder'> 
				<li><a class='social-links-b' href='http://github.com/AlexJuca'><i class="fa fa-github social-icon"></i></a></li>
				<li><a class='social-links-b' href='http://twitter.com/Ajxdev'><i class="fa fa-twitter social-icon"></i></a></li>
				<li><a class='social-links-b' href='http://facebook.com/Alexandre.Juca'><i class="fa fa-facebook social-icon"></i></a></li>
				<li><a class='social-links-b' href='https://plus.google.com/u/0/101379969000403855022/posts'><i class="fa fa-google-plus social-icon"></i></a></li>
			</ul>
		</div>
		<!-- END OF SOCIAL LINKS -->
	</nav>
	<!-- MAIN SECTION -->
	<!-- INTRO SECTION -->
	<div id='hi' class='intro-wrapper'>	
		<div class='intro-box'>
			<h1 class='header-white'> Hi! </h1>
			<div class='lightline'></div>
			<div class='intro-to-me'>
				<a href='../../'><img class='animated bounceInDown my-profile img-circle' src='../../assets/img/AJ.jpg'></img></a>
				<h3 class='my-title animated bounceInLeft'> Alexandre Juca </h3>
				<h3 class='my-title'>Multiplatform Software Developer</h3>
			</div>
			
			<p> I am a multi skilled software developer with knowledge and experience in UX Design, Web Development, Web design, Software architecture and Android Applications. I'm passionate about writing code and teaching people how to code when not busy on projects. I love sharing my knowledge with other people and hearing feedback, I am always looking for challenges and believe that I grow as a person by overcoming them. </p>
		</div>

	</div>

	<!-- END INTRO SECTION -->
	<div id='post-section' class='main-section'>


		<div class='intro-box-blog'>
			<h1 class='newsTitle'>Aumentando os teus poderes com Cython</h1>
			<h3> 06 de Dezembro de 2014 </h3>

			<img class='blog-img-header' src='../../assets/img/06122014.jpg'></img>

			<article class='post-content'>
				<h2> Introdução </h2>
				<p> Cython é uma linguagem de programação que torna escrever extensões em C para a linguagem Python tão fácil quanto o próprio Python. É uma linguagem de programação de alto nível, orientado a objetos, funcional e dinâmico. Sua principal característica é o suporte para as declarações de tipo estático. O código-fonte é traduzida em código C / C ++ , otimizado e compilado como módulos de extensão Python. Isso permite a execução de um programa muito rápido e forte integração com as bibliotecas externas de C, mantendo o programador em alta produção. </p>

				<ul>  <h3> O compilador Cython gera código em C que compila : </h3>
					<li>com todos os principais compiladores(C e C++)</li>
					<li>para todas plataformas principais </li>
					<li> Em python 2.6 até python 3.1 </li>
				</ul>

				<ul>  <h3> Actualmente Cython suporta a sintaxe do Python 2.6 </h3>
					<li> Suporte para python 3.1 e acima esta em desenvolvimento </li>
				</ul>


				<h2> Como instalar </h2>
					
					<p class='code-caption-b'>> Digite o seguinte comando na linha de comandos para instalar o Cython. </p>
					<div class='console-wrapper'>
						<div class='mac-screen'>
						 <pre class='language-c'>


sudo apt-get install cython


						 </pre>
					</div>		
			

				</div>

				<p> Isso irá instalar o Cython e o "python developement headers" ou cabeçalhos para desenvolvimento em Python na sua máquina. </p>
				
				<h2> Compilar código Python para C </h2>
				<p> Agora que tens cython instalado na sua maquina, vamos primeiramente testar a velocidade entre C e Python para conhecer a diferença em velocidade de execução e iremos compilar o nosso Código Cython para C e ver os beneficios que ela poderia trazer para nos. </p>

				<p> Na linha de comandos cria um novo arquivo usando o editor de texto nano com o nome fib.py. Vamos criar um script em Python e C que ira retornar o enésimo elemento da seqüência de Fibonacci. </p>

				<p class='code-caption-b'>A formula para retornar o enésimo elemento da seqüência de Fibonacci</p>
				<img src='../../assets/img/fb01.gif'></img>

				<p class='code-caption-b'> >Vamos criar um arquivo que irá armazenar código em Python.</p>
				<div class='console-wrapper'>
						<div class='mac-screen'>
						 <pre class='language-c'>


alexjuca@alexjuca.github.io:~/Documents/BlogPostProject/Cython$ nano fib.py


						 </pre>
					</div>		
			

				</div>

				<p class='code-caption-b'>> Digite o seguinte código e salva-o com a combinação das teclas Ctrl + O </p>
				
				<div class='console-wrapper'>
						<div class='mac-screen'>
						 <pre class='language-c'>

<span class='py-keyword'>def</span> fib(n):
        <span class='py-keyword'>if</span> n == 0:
                return 0
        <span class='py-keyword'>elif</span> n == 1:
                return 1
        <span class='py-keyword'>else</span>:
                return fib(n-1) + fib(n-2)
x = fib(30)
<span class='py-keyword'>print</span>(x)


						 </pre>
					</div>

				</div>

				

				<p class='code-caption-b'>> Cria um novo arquivo fib.c que irá armazenar o código em C </p>
				<div class='console-wrapper'>
						<div class='mac-screen'>
						 <pre class='language-c'>


alexjuca@alexjuca.github.io:~/Documents/BlogPostProject/Cython$ nano fib.c


						 </pre>
					</div>		
			

				</div>
<p class='code-caption-b'>> Digite o seguinte código e salva-o com a combinação das teclas Ctrl + O </p>

				<div class='console-wrapper'>
						<div class='mac-screen'>
						 <pre class='language-c'>

<span class='include-keyword'>#include</span> <span class='strings'>< stdio.h></span>
<span class='comments'>/* Prototipo */</span>
<span class='c-type'>int</span> fib(<span class='c-type'>int</span> n);

<span class='c-type'>int</span> main()
{

        <span class='c-type'>int</span> f = fib(30);
        printf(" Fib: %d \n", f);
        return 0;

}


<span class='c-type'>int</span> fib(<span class='c-type'>int</span> n)
{

        <span class='control-keyword'>if</span> (n == 0)
        {
                 <span class='ret-keyword'>return</span> 0;
        }
        <span class='control-keyword'>else if</span> (n == 1)
        {
                <span class='ret-keyword'>return</span> 1;
        }
        <span class='control-keyword'>else</span>
        {
                <span class='ret-keyword'>return</span> fib(n-1) + fib(n-2);
        }
}



						 </pre>
					</div>

				</div>

				<p> Bem temos tudo que precisamos para comparar a velocidade entre Python e C.
					Vamos compilar o código em C usando gcc (GNU C Compiler). </p>

				<p class='code-caption-b'>> Digite os seguintes comandos para compilar o código em C </p>
				<!-- console -->	
				<div class='console-wrapper'>
						<div class='mac-screen'>
						 <pre class='language-c'>


alexjuca@alexjuca.github.io:~/Documents/BlogPostProject/Cython$ gcc -g -o fib fib.c


						 </pre>
					</div>		
				</div>
				<!-- console -->

				<p> O gcc compilou o nosso código e criou em ficheiro binário executável com o nome fib. </p>

					<p class='code-caption-b'>> Digite o comando ls para listar os ficheiros do Direitório. Verifica se tens estes ficheiros abaixo no seu diretório </p>
				<!-- console -->	
				<div class='console-wrapper'>
						<div class='mac-screen'>
						 <pre class='language-c'>


alexjuca@alexjuca.github.io:~/Documents/BlogPostProject/Cython$ ls
<span class='file-ok'>fib fib.c fib.py </span>


						 </pre>
					</div>		
				</div>
				<!-- console -->
   				<p> Iremos executar o ficheiro executável com o progama time para saber o tempo que o cpu leva para terminar o processamento do programma. Lembra que o programa irá calcular o enésimo elemento da seqüência de Fibonacci e imprimir-la na tela </p>

   				<p class='code-caption-b'>> Execute o ficheiro executável usando time </p>
				<!-- console -->
				<div class='console-wrapper'>
						<div class='mac-screen'>
						 <pre class='language-c'>


alexjuca@alexjuca.github.io:~/Documents/BlogPostProject/Cython$ time ./fib
 Fib: 832040 

real	0m0.021s
user	0m0.016s
sys	0m0.000s



						 </pre>
					</div>		
			

				</div>
				<!-- console -->
<p> Prontos o código foi executado com sucesso e retornou o valor da seqüência de fibonnaci e tambem o tempo de execução. Levou 0.021s na minha maquina, é possível que ele retorne um tempo diferente na sua maquina por causa do CPU e OS que são diferentes (Na verdade existem várias coisas que podem influenciar os resultados, incluindo os processos, programas abertos e até a sua respiração, ok menos a respiração) A maquina que usei para testes utiliza um processador AMD Athlon II X3 e tem Ubuntu 14.04 como Sistema operativo. </p>

<p> Vamos executar o próximo script em Python. Digite o seguinte código na linha de comandos no mesmo diretório onde coloucaste os ficheiros que criamos anteriormente. </p>

<p class='code-caption-b'>> Executa o código em python usando time </p>
				<!-- console -->
				<div class='console-wrapper'>
						<div class='mac-screen'>
						 <pre class='language-c'>


alexjuca@alexjuca.github.io:~/Documents/BlogPostProject/Cython$ time python fib.py
832040

real	0m0.740s
user	0m0.700s
sys	0m0.008s



						 </pre>
					</div>		
			

				</div>
				<!-- console -->

				<p> Aí cara, é obvio que o programa escrito em C é muito mais rápido que o programa escrito Python2.7. C é 35 vezes mais rápido neste algoritmo que o Python (740 / 21 = 35.). È isso que esperamos de uma linguagem compilada como C que foi criado para ser eficiente e rápido. Mais o importante aqui não é mostrar que C é mais rápido, mas queremos saber como o uso de Cython pode melhorar o desempenho dos nossos programas e facilitar o desenvolvimento de software usando o sintaxe simples do Python e a velocidade e eficiencia da linguagen C. </p>

				<p> Vamos criar um novo arquivo que irá armazenar código em Cython.</p>
				
				<div class='console-wrapper'>
						<div class='mac-screen'>
						 <pre class='language-c'>


alexjuca@alexjuca.github.io:~/Documents/BlogPostProject/Cython$ nano cyfib.pyx


						 </pre>
					</div>		
				</div>

				<p class='code-caption-b'>> Digite o seguinte código e salva-o com a combinação das teclas Ctrl + O </p>

				<div class='console-wrapper'>
						<div class='mac-screen'>
						 <pre class='language-c'>

<span class='py-keyword'>cdef</span> fib(int n):
        <span class='py-keyword'>if</span> n == 0:
                return 0
        <span class='py-keyword'>elif</span> n == 1:
                return 1
        <span class='py-keyword'>else</span>:
                return fib(n-1) + fib(n-2)
<span class='py-keyword'>if</span> __name__ == <span class='py-strings'>'__main__'</span>:
        <span class='py-keyword'>print</span>(x) fib(30)
						 </pre>
					</div>

				</div>

				<p> O código em Cython aparece identico a código em Python, mas observa que declaramos a função cdef e tambem declaramos seu parâmetro n como inteiro. Cython usa essas informações para criar código otimizados. Nos sabemos que estamos falando de um inteiro e tambem conhecemos o scopo dos dados dentro do programa e assim possibilita o armazenamento de dados na pilha (stack).</p>

				<p>Compila o código Cython para C usando os seguintes comandos</p>

				<p class='code-caption-b'>> compila o código Cython para C </p>
				<!-- console -->	
				<div class='console-wrapper'>
						<div class='mac-screen'>
						 <pre class='language-c'>


alexjuca@alexjuca.github.io:~/Documents/BlogPostProject/Cython$ cython --embed cyfib.pyx


						 </pre>
					</div>		
				</div>
				<!-- console -->

				<p> Usamos o compilador do Cython para criar um ficheiro que contém a tradução do código Cython para C e criou um ficheiro com nome cyfib.c Usa o comando ls para visualizar os ficheiros do diretório </p>

				<p class='code-caption-b'>> Exibe os ficheiros do diretório usando ls </p>
				
				<!-- console -->	
				<div class='console-wrapper'>
						<div class='mac-screen'>
						 <pre class='language-c'>


alexjuca@alexjuca.github.io:~/Documents/BlogPostProject/Cython$ ls
<span class='file-ok'>fib fib.c fib.py cyfib.pyx cyfib.c</span>


						 </pre>
					</div>		
				</div>
				<!-- console -->

				<p> Bom agora vamos usa o gcc para compilar o ficheiro cyfib.c em executável </p>

				<p class='code-caption-b'>> Compila o ficheiro cyfib.c usando os seguintes comandos </p>
				<!-- console -->	
				<div class='console-wrapper'>
						<div class='mac-screen'>
						 <pre class='language-c'>


alexjuca@alexjuca.github.io:~/Documents/BlogPostProject/Cython$ gcc -I /usr/include/python2.7 \ 
-o cyfib cyfib.c -lpython2.7 -lpthread -lm -lutil -ldl


						 </pre>
					</div>		
				</div>
				<!-- console -->

<p class='code-caption-b'>> Exibe os ficheiros do diretório usando ls </p>
				
				<!-- console -->	
				<div class='console-wrapper'>
						<div class='mac-screen'>
						 <pre class='language-c'>


alexjuca@alexjuca.github.io:~/Documents/BlogPostProject/Cython$ ls
<span class='file-ok'>cyfib fib fib.c fib.py cyfib.pyx cyfib.c</span>


						 </pre>
					</div>		
				</div>
				<!-- console -->

				<p> Iremos executar o ficheiro executável cyfib com o progama time para saber o tempo que o cpu leva para terminar o processamento do programma.  </p>

   				<p class='code-caption-b'>> Executa o ficheiro executável cyfib usando time </p>
				<!-- console -->
				<div class='console-wrapper'>
						<div class='mac-screen'>
						 <pre class='language-c'>


alexjuca@alexjuca.github.io:~/Documents/BlogPostProject/Cython$time ./cyfib
832040

real	0m0.117s
user	0m0.096s
sys	0m0.004s




						 </pre>
					</div>	
				</div>
				<!-- console -->

				<p> Ótimo, o programa escrito em Cython e convertido para C e finalmente compilado em executável retornou o resultado depois de 0.117s. Isso é muito bom. Mostrando que é 6 vezes mais rápida (740 / 117 = 6.32) do que código em Python. È possível aumentar ainda mais a eficiencia e rapizés do programa usando algumas otimizações. </p>

				<h2> Alternativas </h2>
				<p> Este tipo de ligação de idioma pode também ser
				conseguida através de Swig. Onde o Cython brilha
				é no tipo de coerção e que a execução directa
				oferece. Por exemplo, em Swig você precisa escrever
				um monte de funções tipo de invólucro para coagir
				entre as diferentes línguagens. Você também vai
				precisa escrever funções "wrapper" para lidar com mais
				estruturas de dados complexas. Cython faz isso para
				você por entender os tipos! Não estou
				dizer que o swig é ruim, mas é muito generalizada, uma vez que
				suporta tantas linguagens como Java, Go, etc.,
				tirando todo o código da placa de caldeira necessário.
				Cython é puramente projetado para Python.
			</p>

				<h2> Conclusão </h2>
				<p> Aprendemos que podemos usar Cython para escrever programas escritos em Python que podem ser executadas mais rápidas mas será que tem outras razões para usar-la? Sim existem.</p>

				<ul><h3>Para escrever Extensões em C para Cpython</h3>
					<li>Não trouca de linguagem só para ter codigo mais rápido</li>
					<li>acelerar módulos Python existentes.
concentrar em otimizações, não em reescrevendo código!</li>
<li>Não trouca de linguagem só para ter codigo mais rápido</li>
<li>Envolver Bibliotecas em C usando Python</li>

				</ul>
					









































				<div class='seperator'></div>	
				

				    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'alexjucagithubcom'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    




			</article>



		</div>

	</div>
	
<!-- SCROLL JS Section -->
<ul class='post-read'>
		<li id='drop-to-post'> Ler Postagem: <i class="fa fa-chevron-down post-read-icon"></i></li>
</ul>
<!-- END OF SCROLL JS Section -->

	
<footer class='footer'>
<ul class='social-links'> 
	<h5> &copy; Copyright Alexandre Juca All Rights Reserved </h5>
	<p style="color: #404040; font-size: 15px;"> Designed and Developed with <i class="fa fa-heart social-links-a"></i> by Alexandre Juca </p>
		<li><a class='social-links-a' _target='blank' href='http://github.com/AlexJuca'><i class="fa fa-github social-icon"></i></a></li>
		<li><a class='social-links-a' href='http://twitter.com/Ajxdev'><i class="fa fa-twitter social-icon"></i></a></li>
		<li><a class='social-links-a' href='http://facebook.com/Alexandre.Juca'><i class="fa fa-facebook social-icon"></i></a></li>
		<li><a class='social-links-a' href='https://plus.google.com/u/0/101379969000403855022/posts'><i class="fa fa-google-plus social-icon"></i></a></li>
	</ul>
</footer>
<!-- FOOTER SECTION -->
<!-- JQuery --> 
    <script src='../../assets/js/jquery-2.1.1.min.js'></script>
    <!-- JQuery --> 
<script src='../../assets/js/jquery.scrollTo.min.js'></script>
<script src='../../assets/js/jgo-min.js'></script>
<script src='../../assets/js/jpost-min.js'></script>
<script src='../../assets/js/wintracker-min.js'></script>
 
<!-- Site Generated by HoloPyEngine created by Alexandre Juca -->
</body>
</html>
